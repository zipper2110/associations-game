# kotlin backend

##Как запустить:

В папке проекта выполнить команду:
```
mvnw clean spring-boot:run
```
Должен запуститься сервер на порту 8080.

REST API сервера можно посмотреть и попробовать по url
http://localhost:8080/swagger-ui.html.

## Пользователи

Начиная игру, пользователь вводит любое имя, которое хочет
использовать. Ему не надо создавать аккаунт или вводить пароль.  
Если имя, которое выбрал пользователь, не занято, то он забирает его
себе на время, пока он в игре.  
Когда пользователь становится неактивным (по умолчанию это 2 минуты),
он удаляется с сервера. Имя, которое он использовал, освобождается 
и может быть использовано другим пользователем.  
Если пользователь продолжает совершать действия в игре, то он может 
оставаться активным сколько угодно долго.  
(мб это не очень хорошо, надо удалять пользователя после 16-24 часов,
чтобы не было висящих пользователей и память не утекала).  
Пользователь может сам выйти, если захочет сменить имя или просто 
закончить игру. Тогда его запись удаляется с сервера сразу же,
и имя освобождается.

## Лобби и игровые комнаты

Пользователь должен явно присоединиться к лобби (/game/join-lobby). 
Это нужно, чтобы пользователь получал события из лобби 
(например, создание/удаление комнаты).  
Как только пользователь заходит в лобби, этому пользователю будет 
отправлено сообщение со списком игровых комнат (/user/rooms-list).  
После этого узнавать об обновлениях пользователь будет, слушая 
broadcast-сообщения об изменениях в комнатах:
- создана новая комната (/topic/room-created)
- пользователь зашёл в комнату (/topic/player-joined-room)
- ... TODO

Находясь в лобби, пользователь может:
- создать комнату (/game/create-room)
- присоединиться к существующей комнате (/game/join-room)

Чтобы создать комнату, нужно: 
- отправить запрос на создание комнаты 
- дождаться оповещения от сервера, что комната создана
- присоединиться к комнате

Как только пользователь присоединится к какой-то комнате, ему 
перестанут приходить сообщения об обновлении в лобби, и начнут приходить 
сообщения из комнаты.

Чтобы вернуться в лобби, нужно снова отправить сообщение 
"присоединиться к лобби".

## Нигде

Изначально пользователь находится нигде. Он не получает никаких событий.

Чтобы вернуться в "нигде", нужно отправить сообщение в /game/go-nowhere.